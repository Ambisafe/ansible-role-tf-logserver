version: '2.1'

services:
  proxy:
    image: nginx:{{ ec2_nginx_version }}
    container_name: proxy
    hostname: proxy
    restart: always
    logging:
      driver: "awslogs"
      options:
         awslogs-region: "{{ aws_region }}"
         awslogs-group: "logserver"
         awslogs-stream: "nginx"
         awslogs-create-group: "true"
    ports:
      - 80:80
    volumes:
      - nginx.conf:/etc/nginx/nginx.conf
      - .htpasswd:/etc/nginx/.htpasswd
    networks:
      logserver:

networks:
  logserver:
